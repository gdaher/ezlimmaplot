<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Jonathan Dreyfuss" />

<meta name="date" content="2018-06-07" />

<title>ezlimmaplot vignette</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">ezlimmaplot vignette</h1>
<h4 class="author"><em>Jonathan Dreyfuss</em></h4>
<h4 class="date"><em>2018-06-07</em></h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Welcome to <strong>ezlimmaplot</strong>. This package is for plotting bioinformatics results, especially those from the <strong>ezlimma</strong> package. Here, I’ll load both packages, create some output with <strong>ezlimma</strong>, and then plot it with <strong>ezlimmaplot</strong>.</p>
</div>
<div id="install-package" class="section level2">
<h2>Install package</h2>
<p>See README.md.</p>
</div>
<div id="load-package" class="section level2">
<h2>Load package</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ezlimma)</code></pre></div>
<pre><code>## Loading required package: limma</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ezlimmaplot)</code></pre></div>
</div>
<div id="simulate-data" class="section level2">
<h2>Simulate data</h2>
<p>To demonstrate the package on a dataset, I’ll simulate log2 expression data with 100 genes and 6 samples in two groups, with the first gene up-regulated in the first group. This is the example data from <strong>limma</strong> <code>contrasts.fit</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">42</span>)
M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span><span class="op">*</span><span class="dv">6</span>, <span class="dt">sd=</span><span class="fl">0.3</span>), <span class="dt">nrow=</span><span class="dv">100</span>, <span class="dt">ncol=</span><span class="dv">6</span>)
<span class="kw">dimnames</span>(M) &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">paste0</span>(<span class="st">&quot;gene&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(M)), <span class="kw">paste0</span>(<span class="st">&quot;sample&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(M)))
grp &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;First3&quot;</span>, <span class="st">&quot;Last3&quot;</span>), <span class="dt">each=</span><span class="dv">3</span>)
pheno &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">row.names =</span> <span class="kw">colnames</span>(M), <span class="dt">sample=</span><span class="kw">colnames</span>(M), <span class="dt">grp=</span>grp, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
M[<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] &lt;-<span class="st"> </span>M[<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] <span class="op">+</span><span class="st"> </span><span class="dv">2</span></code></pre></div>
</div>
<div id="principal-component-analysis-pca" class="section level2">
<h2>Principal component analysis (PCA)</h2>
<p>We can plot the samples by their first two principal components using the <strong>ggplot2</strong> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ezpca</span>(M, pheno, <span class="dt">color=</span><span class="st">&quot;grp&quot;</span>, <span class="dt">name=</span><span class="ot">NA</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We pass <code>color=&quot;grp&quot;</code> via … to <strong>ggplot2</strong> <code>aes_string</code>, where <code>&quot;grp&quot;</code> can be any of <code>colnames(pheno)}</code>. We could similarly have used <code>color=&quot;grp&quot;</code>. We set <code>name=NA</code> to suppress plotting to file.</p>
</div>
<div id="gene-level-differential-analysis" class="section level2">
<h2>Gene level differential analysis</h2>
<p>Assume we want to test if genes are changed in First3, in Last3, or in Last3 - First3. We can do this in two lines of code,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">contr.v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">First3=</span><span class="st">&quot;First3&quot;</span>, <span class="dt">Last3=</span><span class="st">&quot;Last3&quot;</span>, <span class="dt">Last3vsFirst3=</span><span class="st">&quot;Last3-First3&quot;</span>)
res &lt;-<span class="st"> </span><span class="kw">limma_contrasts</span>(M, <span class="dt">grp=</span>grp, <span class="dt">contrast.v =</span> contr.v)</code></pre></div>
<p>We add a column of gene symbols to the top genes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">signif</span>(res, <span class="dv">3</span>), <span class="dt">Gene.Symbol=</span><span class="ot">NA</span>)
res.df<span class="op">$</span>Gene.Symbol[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>] &lt;-<span class="st"> </span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<p>This returns a data frame that looks like:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">First3.avg</th>
<th align="right">Last3.avg</th>
<th align="right">First3.p</th>
<th align="right">First3.FDR</th>
<th align="right">First3.logFC</th>
<th align="right">First3.FC</th>
<th align="right">Last3.p</th>
<th align="right">Last3.FDR</th>
<th align="right">Last3.logFC</th>
<th align="right">Last3.FC</th>
<th align="right">Last3vsFirst3.p</th>
<th align="right">Last3vsFirst3.FDR</th>
<th align="right">Last3vsFirst3.logFC</th>
<th align="right">Last3vsFirst3.FC</th>
<th align="left">Gene.Symbol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>gene1</td>
<td align="right">2.0600</td>
<td align="right">0.236</td>
<td align="right">0.00000</td>
<td align="right">0.000</td>
<td align="right">2.0600</td>
<td align="right">4.16</td>
<td align="right">0.156000</td>
<td align="right">0.741</td>
<td align="right">0.236</td>
<td align="right">1.18</td>
<td align="right">0.000000</td>
<td align="right">0.0000</td>
<td align="right">-1.820</td>
<td align="right">-3.53</td>
<td align="left">A</td>
</tr>
<tr class="even">
<td>gene25</td>
<td align="right">0.2320</td>
<td align="right">0.593</td>
<td align="right">0.16300</td>
<td align="right">0.987</td>
<td align="right">0.2320</td>
<td align="right">1.17</td>
<td align="right">0.000401</td>
<td align="right">0.020</td>
<td align="right">0.593</td>
<td align="right">1.51</td>
<td align="right">0.125000</td>
<td align="right">0.7080</td>
<td align="right">0.360</td>
<td align="right">1.28</td>
<td align="left">B</td>
</tr>
<tr class="odd">
<td>gene74</td>
<td align="right">0.1170</td>
<td align="right">-0.609</td>
<td align="right">0.48200</td>
<td align="right">0.987</td>
<td align="right">0.1170</td>
<td align="right">1.08</td>
<td align="right">0.000278</td>
<td align="right">0.020</td>
<td align="right">-0.609</td>
<td align="right">-1.53</td>
<td align="right">0.002140</td>
<td align="right">0.0713</td>
<td align="right">-0.726</td>
<td align="right">-1.65</td>
<td align="left">C</td>
</tr>
<tr class="even">
<td>gene59</td>
<td align="right">-0.4540</td>
<td align="right">0.359</td>
<td align="right">0.00648</td>
<td align="right">0.198</td>
<td align="right">-0.4540</td>
<td align="right">-1.37</td>
<td align="right">0.031400</td>
<td align="right">0.431</td>
<td align="right">0.359</td>
<td align="right">1.28</td>
<td align="right">0.000593</td>
<td align="right">0.0297</td>
<td align="right">0.813</td>
<td align="right">1.76</td>
<td align="left">D</td>
</tr>
<tr class="odd">
<td>gene17</td>
<td align="right">-0.0929</td>
<td align="right">-0.469</td>
<td align="right">0.57600</td>
<td align="right">0.987</td>
<td align="right">-0.0929</td>
<td align="right">-1.07</td>
<td align="right">0.004930</td>
<td align="right">0.164</td>
<td align="right">-0.469</td>
<td align="right">-1.38</td>
<td align="right">0.110000</td>
<td align="right">0.7080</td>
<td align="right">-0.376</td>
<td align="right">-1.30</td>
<td align="left">E</td>
</tr>
<tr class="even">
<td>gene12</td>
<td align="right">0.4430</td>
<td align="right">-0.148</td>
<td align="right">0.00791</td>
<td align="right">0.198</td>
<td align="right">0.4430</td>
<td align="right">1.36</td>
<td align="right">0.372000</td>
<td align="right">0.917</td>
<td align="right">-0.148</td>
<td align="right">-1.11</td>
<td align="right">0.012200</td>
<td align="right">0.2430</td>
<td align="right">-0.591</td>
<td align="right">-1.51</td>
<td align="left">F</td>
</tr>
<tr class="odd">
<td>gene4</td>
<td align="right">0.4540</td>
<td align="right">0.092</td>
<td align="right">0.00651</td>
<td align="right">0.198</td>
<td align="right">0.4540</td>
<td align="right">1.37</td>
<td align="right">0.580000</td>
<td align="right">0.917</td>
<td align="right">0.092</td>
<td align="right">1.07</td>
<td align="right">0.124000</td>
<td align="right">0.7080</td>
<td align="right">-0.362</td>
<td align="right">-1.29</td>
<td align="left">G</td>
</tr>
<tr class="even">
<td>gene66</td>
<td align="right">0.3800</td>
<td align="right">-0.229</td>
<td align="right">0.02260</td>
<td align="right">0.323</td>
<td align="right">0.3800</td>
<td align="right">1.30</td>
<td align="right">0.169000</td>
<td align="right">0.741</td>
<td align="right">-0.229</td>
<td align="right">-1.17</td>
<td align="right">0.009890</td>
<td align="right">0.2430</td>
<td align="right">-0.609</td>
<td align="right">-1.52</td>
<td align="left">H</td>
</tr>
<tr class="odd">
<td>gene13</td>
<td align="right">-0.1770</td>
<td align="right">-0.383</td>
<td align="right">0.28800</td>
<td align="right">0.987</td>
<td align="right">-0.1770</td>
<td align="right">-1.13</td>
<td align="right">0.021700</td>
<td align="right">0.412</td>
<td align="right">-0.383</td>
<td align="right">-1.30</td>
<td align="right">0.381000</td>
<td align="right">0.8940</td>
<td align="right">-0.206</td>
<td align="right">-1.15</td>
<td align="left">I</td>
</tr>
<tr class="even">
<td>gene60</td>
<td align="right">0.1190</td>
<td align="right">-0.395</td>
<td align="right">0.47400</td>
<td align="right">0.987</td>
<td align="right">0.1190</td>
<td align="right">1.09</td>
<td align="right">0.017800</td>
<td align="right">0.412</td>
<td align="right">-0.395</td>
<td align="right">-1.32</td>
<td align="right">0.029200</td>
<td align="right">0.4170</td>
<td align="right">-0.514</td>
<td align="right">-1.43</td>
<td align="left">J</td>
</tr>
</tbody>
</table>
</div>
<div id="significance-histogram" class="section level2">
<h2>Significance histogram</h2>
<p>We can plot a histogram of the p-values and FDRs for all comparisons with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">signif_hist</span>(res, <span class="dt">name=</span><span class="ot">NA</span>) <span class="co">#not run</span></code></pre></div>
<p><code>signif_hist</code> plots four histograms per page, and this line will plot two histograms per comparison x 3 comparisons = 6 histograms. Thus, this takes more than one page, so it is not shown here.</p>
</div>
<div id="venn-diagram" class="section level2">
<h2>Venn diagram</h2>
<p>We may want to see which genes are up or down in each comparison, and how the significant genes (say p-value &lt; 0.05) behave in different comparisons using a Venn diagram.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ezvenn</span>(<span class="dt">tab=</span>res, <span class="dt">p.cutoff =</span> <span class="fl">0.05</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="dotplot-and-boxplot" class="section level2">
<h2>Dotplot and boxplot</h2>
<p>We can plot the top gene by group in a dotplot or boxplot using <strong>ggplot2</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_by_grp</span>(M[<span class="dv">1</span>,], pheno<span class="op">$</span>grp, <span class="dt">name=</span><span class="ot">NA</span>, <span class="dt">type=</span><span class="st">&quot;dot&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_by_grp</span>(M[<span class="dv">1</span>,], pheno<span class="op">$</span>grp, <span class="dt">name=</span><span class="ot">NA</span>, <span class="dt">type=</span><span class="st">&quot;box&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can plot multiple genes, such as the first 5 genes where each gene will be on its own page in a PDF, by passing <code>object=M[1:5,]</code>.</p>
</div>
<div id="heatmap" class="section level2">
<h2>Heatmap</h2>
<p>We plot a heatmap of the expression of the first five genes across all samples using the <strong>pheatmap</strong> package. We assume their gene symbols are “A”, “B”, “C”, “D”, “E”. We make a phenotype dataframe with only one column for the group, and with , which <strong>pheatmap</strong> checks for.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sym &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>)
pheno.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">row.names =</span> <span class="kw">rownames</span>(pheno), <span class="dt">grp=</span>pheno<span class="op">$</span>grp)
topgenes &lt;-<span class="st"> </span><span class="kw">rownames</span>(res.df)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]
<span class="kw">ezheat</span>(M[topgenes,], <span class="dt">symbols =</span> res.df[topgenes, <span class="st">&quot;Gene.Symbol&quot;</span>], <span class="dt">pheno.df=</span>pheno.df, <span class="dt">name=</span><span class="ot">NA</span>)</code></pre></div>
<p>We see a color bar for the phenotype groups and the strongest change in metabolite “A”.</p>
</div>
<div id="volcano-plots" class="section level2">
<h2>Volcano plots</h2>
<p>We can create volcano plots, which have logFC on the x-axis and log(p-value) on the y-axis, for a comparison using <strong>ggplot2</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ezvolcano</span>(<span class="dt">tab=</span>res.df, <span class="dt">comparison =</span> <span class="st">&quot;First3&quot;</span>, <span class="dt">name=</span><span class="ot">NA</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can automatically create a PDF with volcano plots for all comparisons with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">multi_volcano</span>(<span class="dt">tab=</span>res.df)</code></pre></div>
</div>
<div id="system-info" class="section level2">
<h2>System info</h2>
<p>Here is the information on the system on which this document was compiled:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>## R version 3.5.0 (2018-04-23)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 7 x64 (build 7601) Service Pack 1
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_United States.1252 
## [2] LC_CTYPE=English_United States.1252   
## [3] LC_MONETARY=English_United States.1252
## [4] LC_NUMERIC=C                          
## [5] LC_TIME=English_United States.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] ezlimmaplot_0.0.0.9000 ezlimma_0.1.6          limma_3.36.1          
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.16       knitr_1.20         magrittr_1.5      
##  [4] munsell_0.4.3      colorspace_1.3-2   rlang_0.2.0       
##  [7] highr_0.6          stringr_1.3.1      plyr_1.8.4        
## [10] tools_3.5.0        grid_3.5.0         gtable_0.2.0      
## [13] htmltools_0.3.6    yaml_2.1.19        lazyeval_0.2.1    
## [16] rprojroot_1.3-2    digest_0.6.15      tibble_1.4.2      
## [19] RColorBrewer_1.1-2 ggplot2_2.2.1      evaluate_0.10.1   
## [22] rmarkdown_1.9      labeling_0.3       pheatmap_1.0.8    
## [25] stringi_1.1.7      pillar_1.2.2       compiler_3.5.0    
## [28] scales_0.5.0       backports_1.1.2</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
